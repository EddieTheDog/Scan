<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>
<style>
  body { font-family: sans-serif; padding: 30px; }
  table { border-collapse: collapse; width: 100%; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
  button { margin: 0 5px; }
</style>
</head>
<body>
<h1>Admin Panel - Pending Check-Ins</h1>
<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Name</th>
      <th>Seat</th>
      <th>QR</th>
      <th>Scanned At</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody id="list"></tbody>
</table>

<script>
window.checkins = window.checkins || []; // shared array

function loadList() {
  const tbody = document.getElementById("list");
  tbody.innerHTML = "";

  window.checkins
    .filter(c => c.status === "pending")
    .forEach(c => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${c.id}</td>
        <td>${c.name}</td>
        <td>${c.seat}</td>
        <td>${c.qr}</td>
        <td>${c.scannedAt}</td>
        <td>
          <button onclick="approve(${c.id})">Approve</button>
          <button onclick="decline(${c.id})">Decline</button>
        </td>
      `;
      tbody.appendChild(tr);
    });
}

function approve(id) {
  const entry = window.checkins.find(c => c.id === id);
  if (entry) {
    entry.status = "approved";
    entry.approvedAt = new Date().toLocaleString();
  }
  loadList();
}

function decline(id) {
  const entry = window.checkins.find(c => c.id === id);
  if (entry) {
    entry.status = "declined";
    entry.approvedAt = new Date().toLocaleString();
  }
  loadList();
}

// Auto-refresh every 3 seconds
setInterval(loadList, 3000);
loadList();
</script>
</body>
</html>
